import{a as z,b as E}from"./index-BF9ftXQd.js";import{i as I}from"./echarts-CAET2t7N.js";import{b as S}from"./@vueuse-C9VPALwM.js";import{_ as V}from"./index-BJvExNm_.js";import{r as f,b as x,D as A,w as L,c as U,V as a,P as l,a as m,ai as n,o as B}from"./@vue-BdlgX6Tj.js";import"./axios-BimPEqV4.js";import"./nprogress-DrSneiWl.js";import"./dayjs-DuEr9S7h.js";import"./element-plus-YFWp-VKW.js";import"./lodash-es-D0J8aJCM.js";import"./@element-plus-BcF8Tb1I.js";import"./@popperjs-CsO2-mKt.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-BTg-XjMW.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-CW9Ge4bl.js";import"./tslib-BDyQ-Jie.js";import"./zrender-B5ljRYTo.js";import"./pinia-B1eGvOHX.js";import"./vue-router-dLXZBElL.js";import"./pinia-plugin-persistedstate-Bts6f1YT.js";const C={class:"topology-container"},D={class:"search-bar"},N={class:"card-container"},R={__name:"ServiceTopology",setup(q){const u=f(""),w=async(t,e)=>{const r=await z(t);if(r===null)return;const o=r.result.map(p=>({value:p}));e(o)},g=f([]),v=f([]),b=async()=>{const t=await E(u.value),e=t.result.nodes;g.value=e.map(o=>o.nodeObject!==null?{draggable:!0,name:o.nodeObject.name,category:o.nodeObject.nodeName,symbolSize:[50,50]}:null);const r=t.result.calls;v.value=r.map(o=>o.source===null||o.target===null?null:{source:o.source.nodeObject.name,target:o.target.nodeObject.name})};let d;x(async()=>{await b(),y(),window.addEventListener("resize",c),d=new ResizeObserver(()=>c),d.observe(document.getElementById("service-topology-dom"))}),A(()=>{window.removeEventListener("resize",c),d.disconnect()});let i;const s=S("theme-appearance","auto"),y=()=>{i&&i.dispose();let t={backgroundColor:s.value==="dark"?"#212224":"#fff",title:{text:"\u670D\u52A1\u5173\u7CFB\u56FE"},tooltip:{trigger:"item",triggerOn:"mousemove",backgroundColor:s.value==="dark"?"#212224":"#fff",textStyle:{color:s.value==="dark"?"#fff":"#212224"}},label:{normal:{show:!0,position:"inside"}},series:[{type:"graph",edgeSymbol:["none","arrow"],focusNodeAdjacency:!0,roam:!0,layout:"force",symbol:"circle",data:g.value,links:v.value,label:{normal:{show:!0,position:"inside"}},force:{repulsion:200,edgeLength:100,layoutAnimation:!0},animationEasingUpdate:"quinticInOut",animationDurationUpdate:100}]};i=I(document.getElementById("service-topology-dom"),s.value==="dark"?"dark":"light"),i.setOption(t)},c=()=>{i&&i.resize()};return L(s,()=>{y()}),(t,e)=>{const r=n("el-breadcrumb-item"),o=n("el-breadcrumb"),p=n("el-row"),h=n("Filter"),_=n("el-icon"),O=n("el-autocomplete"),k=n("el-card");return B(),U("div",C,[a(p,null,{default:l(()=>[a(o,{"separator-icon":"ArrowRight"},{default:l(()=>[a(r,null,{default:l(()=>e[1]||(e[1]=[m("a",{href:"/main"},"\u4E3B\u9875",-1)])),_:1}),a(r,null,{default:l(()=>e[2]||(e[2]=[m("a",{href:"/main/topology"},"\u670D\u52A1\u62D3\u6251",-1)])),_:1})]),_:1})]),_:1}),m("div",D,[a(O,{class:"auto-complete-input",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=j=>u.value=j),"fetch-suggestions":w,clearable:"",placeholder:"\u8BF7\u9009\u62E9\u547D\u540D\u7A7A\u95F4--\u9ED8\u8BA4\u4E3Adefault",onSelect:b,style:{width:"40%"}},{prepend:l(()=>[a(_,null,{default:l(()=>[a(h)]),_:1})]),_:1},8,["modelValue"])]),m("div",N,[a(k,null,{default:l(()=>e[3]||(e[3]=[m("div",{id:"service-topology-dom"},null,-1)])),_:1})])])}}},T=V(R,[["__scopeId","data-v-9e4e02aa"]]);export{T as default};
