import{b as O,a as k}from"./index-BIGPZr2-.js";import{i as S}from"./echarts-CAET2t7N.js";import{b as j}from"./@vueuse-CMkOXHT3.js";import{_}from"./index-ItcoEKTc.js";import{r as b,b as E,D as z,w as I,o as w,c as h,V as r,P as s,a as f,ai as i}from"./@vue-9d-ZWrow.js";import"./axios-BimPEqV4.js";import"./nprogress-DrSneiWl.js";import"./dayjs-DuEr9S7h.js";import"./element-plus-CqEfOaYE.js";import"./lodash-es-D0J8aJCM.js";import"./@element-plus-DNs7Qi0T.js";import"./@popperjs-CsO2-mKt.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-BTg-XjMW.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-CW9Ge4bl.js";import"./tslib-BDyQ-Jie.js";import"./zrender-B5ljRYTo.js";import"./pinia-yt7DUaCk.js";import"./vue-router-DNZaI-R-.js";import"./pinia-plugin-persistedstate-Bts6f1YT.js";const V={class:"card-container"},x={__name:"ServiceTopologyDiagram",props:{namespace:String},setup(y){const u=y,p=b([]),c=b([]),e=async()=>{const n=await O(u.namespace),m=n.result.nodes;p.value=m.map(l=>l.nodeObject!==null?{draggable:!0,name:l.nodeObject.name,category:l.nodeObject.status?0:1,symbolSize:[50,50]}:null);const v=n.result.calls;c.value=v.map(l=>l.source===null||l.target===null?null:{source:l.source.nodeObject.name,target:l.target.nodeObject.name})};let a;E(async()=>{await e(),g(),window.addEventListener("resize",d),a=new ResizeObserver(()=>d),a.observe(document.getElementById("service-topology-dom"))}),z(()=>{window.removeEventListener("resize",d),a.disconnect()});let o;const t=j("theme-appearance","auto"),g=()=>{o&&o.dispose();let n={backgroundColor:t.value==="dark"?"#212224":"#fff",title:{text:"\u670D\u52A1\u5173\u7CFB\u56FE"},legend:{},color:["#6EF780","#FF2700"],tooltip:{trigger:"item",triggerOn:"mousemove",backgroundColor:t.value==="dark"?"#212224":"#fff",textStyle:{color:t.value==="dark"?"#fff":"#212224"}},label:{normal:{show:!0,position:"inside"}},series:[{type:"graph",edgeSymbol:["none","arrow"],focusNodeAdjacency:!0,roam:!0,layout:"force",symbol:"circle",data:p.value,links:c.value,label:{normal:{show:!0,position:"inside"}},force:{repulsion:200,edgeLength:100,layoutAnimation:!0},animationEasingUpdate:"quinticInOut",animationDurationUpdate:100,categories:[{name:"\u670D\u52A1\u5728\u7EBF"},{name:"\u670D\u52A1\u79BB\u7EBF\u6216\u72B6\u6001\u672A\u77E5"}]}]};o=S(document.getElementById("service-topology-dom"),t.value==="dark"?"dark":"light"),o.setOption(n)},d=()=>{o&&o.resize()};return I(t,()=>{g()}),(n,m)=>{const v=i("el-card");return w(),h("div",V,[r(v,null,{default:s(()=>m[0]||(m[0]=[f("div",{id:"service-topology-dom"},null,-1)])),_:1})])}}},D=_(x,[["__scopeId","data-v-ad831777"]]),F={class:"topology-container"},T={class:"search-bar"},A={__name:"ServiceTopology",setup(y){const u=b(""),p=async(c,e)=>{const a=await k(c);if(a===null)return;const o=a.result.map(t=>({value:t}));e(o)};return(c,e)=>{const a=i("el-breadcrumb-item"),o=i("el-breadcrumb"),t=i("el-row"),g=i("Filter"),d=i("el-icon"),n=i("el-autocomplete");return w(),h("div",F,[r(t,null,{default:s(()=>[r(o,{"separator-icon":"ArrowRight"},{default:s(()=>[r(a,null,{default:s(()=>e[1]||(e[1]=[f("a",{href:"/main"},"\u4E3B\u9875",-1)])),_:1}),r(a,null,{default:s(()=>e[2]||(e[2]=[f("a",{href:"/main/topology"},"\u670D\u52A1\u62D3\u6251",-1)])),_:1})]),_:1})]),_:1}),f("div",T,[r(n,{class:"auto-complete-input",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=m=>u.value=m),"fetch-suggestions":p,clearable:"",placeholder:"\u8BF7\u9009\u62E9\u547D\u540D\u7A7A\u95F4--\u9ED8\u8BA4\u4E3Adefault",onSelect:c.getTopology,style:{width:"40%"}},{prepend:s(()=>[r(d,null,{default:s(()=>[r(g)]),_:1})]),_:1},8,["modelValue","onSelect"])]),r(D,{namespace:u.value},null,8,["namespace"])])}}},B=_(A,[["__scopeId","data-v-abe8eebd"]]);export{B as default};
