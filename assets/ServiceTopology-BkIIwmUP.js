import{a as E,b as z}from"./index-B66VEAmS.js";import{i as F}from"./echarts-CAET2t7N.js";import{b as I}from"./@vueuse-C5GirQr1.js";import{_ as S}from"./index-jvRVvdQ8.js";import{r as g,b as V,D as x,w as A,c as L,V as t,P as l,a as m,ai as n,o as U}from"./@vue-BN9FX5Kd.js";import"./axios-BimPEqV4.js";import"./nprogress-DrSneiWl.js";import"./dayjs-DuEr9S7h.js";import"./element-plus-Du0MvhR9.js";import"./lodash-es-D0J8aJCM.js";import"./@element-plus-BjWKHK4M.js";import"./@popperjs-CsO2-mKt.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-BTg-XjMW.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-B6fDCfyv.js";import"./@floating-ui-CW9Ge4bl.js";import"./tslib-BDyQ-Jie.js";import"./zrender-B5ljRYTo.js";import"./pinia-CWoSVrwJ.js";import"./vue-router-CdM3SS_q.js";import"./pinia-plugin-persistedstate-Bts6f1YT.js";const B={class:"topology-container"},C={class:"search-bar"},D={class:"card-container"},N={__name:"ServiceTopology",setup(T){const u=g(""),w=async(a,e)=>{const r=await E(a);if(r===null)return;const o=r.result.map(p=>({value:p}));e(o)},f=g([]),v=g([]),b=async()=>{const a=await z(u.value),e=a.result.nodes;f.value=e.map(o=>o.nodeObject!==null?{draggable:!0,name:o.nodeObject.name,category:o.nodeObject.status?0:1,symbolSize:[50,50]}:null);const r=a.result.calls;v.value=r.map(o=>o.source===null||o.target===null?null:{source:o.source.nodeObject.name,target:o.target.nodeObject.name})};let c;V(async()=>{await b(),y(),window.addEventListener("resize",d),c=new ResizeObserver(()=>d),c.observe(document.getElementById("service-topology-dom"))}),x(()=>{window.removeEventListener("resize",d),c.disconnect()});let i;const s=I("theme-appearance","auto"),y=()=>{i&&i.dispose();let a={backgroundColor:s.value==="dark"?"#212224":"#fff",title:{text:"\u670D\u52A1\u5173\u7CFB\u56FE"},legend:{},color:["#6EF780","#FF2700"],tooltip:{trigger:"item",triggerOn:"mousemove",backgroundColor:s.value==="dark"?"#212224":"#fff",textStyle:{color:s.value==="dark"?"#fff":"#212224"}},label:{normal:{show:!0,position:"inside"}},series:[{type:"graph",edgeSymbol:["none","arrow"],focusNodeAdjacency:!0,roam:!0,layout:"force",symbol:"circle",data:f.value,links:v.value,label:{normal:{show:!0,position:"inside"}},force:{repulsion:200,edgeLength:100,layoutAnimation:!0},animationEasingUpdate:"quinticInOut",animationDurationUpdate:100,categories:[{name:"\u670D\u52A1\u5728\u7EBF"},{name:"\u670D\u52A1\u79BB\u7EBF\u6216\u72B6\u6001\u672A\u77E5"}]}]};i=F(document.getElementById("service-topology-dom"),s.value==="dark"?"dark":"light"),i.setOption(a)},d=()=>{i&&i.resize()};return A(s,()=>{y()}),(a,e)=>{const r=n("el-breadcrumb-item"),o=n("el-breadcrumb"),p=n("el-row"),h=n("Filter"),_=n("el-icon"),O=n("el-autocomplete"),k=n("el-card");return U(),L("div",B,[t(p,null,{default:l(()=>[t(o,{"separator-icon":"ArrowRight"},{default:l(()=>[t(r,null,{default:l(()=>e[1]||(e[1]=[m("a",{href:"/main"},"\u4E3B\u9875",-1)])),_:1}),t(r,null,{default:l(()=>e[2]||(e[2]=[m("a",{href:"/main/topology"},"\u670D\u52A1\u62D3\u6251",-1)])),_:1})]),_:1})]),_:1}),m("div",C,[t(O,{class:"auto-complete-input",modelValue:u.value,"onUpdate:modelValue":e[0]||(e[0]=j=>u.value=j),"fetch-suggestions":w,clearable:"",placeholder:"\u8BF7\u9009\u62E9\u547D\u540D\u7A7A\u95F4--\u9ED8\u8BA4\u4E3Adefault",onSelect:b,style:{width:"40%"}},{prepend:l(()=>[t(_,null,{default:l(()=>[t(h)]),_:1})]),_:1},8,["modelValue"])]),m("div",D,[t(k,null,{default:l(()=>e[3]||(e[3]=[m("div",{id:"service-topology-dom"},null,-1)])),_:1})])])}}},R=S(N,[["__scopeId","data-v-ef491e4e"]]);export{R as default};
