import{d as k}from"./destr-CVtkxrq9.js";import{d as y,a as g}from"./deep-pick-omit-CegYQlcN.js";function m(r,{storage:n,serializer:t,key:i,debug:s,pick:a,omit:o,beforeHydrate:e,afterHydrate:c},d,l=!0){try{l&&(e==null||e(d));const p=n.getItem(i);if(p){const u=t.deserialize(p),f=a?y(u,a):u,h=o?g(f,o):f;r.$patch(h)}l&&(c==null||c(d))}catch(p){s&&console.error("[pinia-plugin-persistedstate]",p)}}function b(r,{storage:n,serializer:t,key:i,debug:s,pick:a,omit:o}){try{const e=a?y(r,a):r,c=o?g(e,o):e,d=t.serialize(c);n.setItem(i,d)}catch(e){s&&console.error("[pinia-plugin-persistedstate]",e)}}function z(r,n,t){const{pinia:i,store:s,options:{persist:a=t}}=r;if(!a)return;if(!(s.$id in i.state.value)){const e=i._s.get(s.$id.replace("__hot:",""));e&&Promise.resolve().then(()=>e.$persist());return}const o=(Array.isArray(a)?a:a===!0?[{}]:[a]).map(n);s.$hydrate=({runHooks:e=!0}={})=>{o.forEach(c=>{m(s,c,r,e)})},s.$persist=()=>{o.forEach(e=>{b(s.$state,e)})},o.forEach(e=>{m(s,e,r),s.$subscribe((c,d)=>b(d,e),{detached:!0})})}function $(r={}){return function(n){z(n,t=>({key:(r.key?r.key:i=>i)(t.key??n.store.$id),debug:t.debug??r.debug??!1,serializer:t.serializer??r.serializer??{serialize:i=>JSON.stringify(i),deserialize:i=>k(i)},storage:t.storage??r.storage??window.localStorage,beforeHydrate:t.beforeHydrate,afterHydrate:t.afterHydrate,pick:t.pick,omit:t.omit}),r.auto??!1)}}var H=$();export{H as s};
