import{a as E,g as N}from"./index-BgX6ccBS.js";import{b as V}from"./index-smoZw7E1.js";import{b as C}from"./@vueuse-BrKJyrsM.js";import{ad as D,w as k,b as I,W as L,c as g,o as w,r as b,X as R,Q as t,I as o,ag as s,M as v,a as y}from"./@vue-CnBZ4jx_.js";import{_ as x}from"./index-Dp-vnoFp.js";import"./axios-DW_MHI2K.js";import"./nprogress-Dx41icWA.js";import"./dayjs-B_aAqRSu.js";import"./arktourosUiConfigUtil-DM9bp1OR.js";import"./element-plus-0z3gLYqD.js";import"./lodash-es-C-xrcuFl.js";import"./@element-plus-Rv25Faa4.js";import"./@popperjs-DB1lLFnh.js";import"./@ctrl-r5W6hzzQ.js";import"./async-validator-CRx4dHSJ.js";import"./memoize-one-BdPwpGay.js";import"./normalize-wheel-es-BQoi3Ox2.js";import"./@floating-ui-BCLhozDd.js";import"./pinia-B3EJDjGG.js";import"./vue-router-DZ3MrWk1.js";import"./pinia-plugin-persistedstate-8SpmOswp.js";import"./destr-CVtkxrq9.js";import"./deep-pick-omit-CegYQlcN.js";const H={id:"trace-timeout-histogram-div"},U={__name:"TraceTimeoutDiagram",props:{spanNameCascade:Array,startAndStopTime:Array},setup(_,{expose:i}){const d=_,{spanNameCascade:h,startAndStopTime:c}=D(d),n=async()=>{console.log(h.value),console.log(c.value)},a=C("theme-appearance","auto");k(a,()=>{n()}),i({drawSpanTimoutHistogram:n});let l;I(()=>{window.addEventListener("resize",m),l=new ResizeObserver(()=>m),l.observe(document.getElementById("trace-timeout-histogram-div"))}),L(()=>{window.removeEventListener("resize",m),l.disconnect()});const m=()=>{};return(r,e)=>(w(),g("div",H))}},B={class:"trace-main-container"},M={style:{"margin-top":"1%"}},q={__name:"TraceTimeout",setup(_){const i=b([]),d=b(),h=R({lazy:!0,async lazyLoad(n,a){const l=[],{level:m}=n;if(m===0){const r=await E();if(r===null)return;r.result.map(e=>({leaf:!1,value:e,label:e})).forEach(e=>{l.push(e)})}else if(m===1){const r=await N({query:"",namespace:n.value,pageNum:1,pageSize:1e3});if(r===null)return;r.result.data.map(e=>({leaf:!1,value:e.name,label:e.name===""?"null":e.name})).forEach(e=>{l.push(e)})}else if(m===2){let r=null,e=null;i.value!=null&&i.value.length===2&&(r=Date.parse(i.value[0]),e=Date.parse(i.value[1]));const u=await V(n.value,r,e);if(u===null)return;u.result.map(p=>({leaf:!0,value:p,label:p})).forEach(p=>{l.push(p)})}a(l)}}),c=b();return(n,a)=>{const l=s("el-breadcrumb-item"),m=s("el-breadcrumb"),r=s("el-row"),e=s("el-date-picker"),u=s("el-form-item"),p=s("el-cascader"),T=s("el-button"),S=s("el-form"),A=s("el-divider"),z=s("el-card");return w(),g("div",B,[t(r,{class:"breadcrumb-header-row"},{default:o(()=>[t(m,{"separator-icon":"ArrowRight"},{default:o(()=>[t(l,{to:{path:"/main"}},{default:o(()=>a[3]||(a[3]=[v(" \u4E3B\u9875 ")])),_:1}),t(l,null,{default:o(()=>a[4]||(a[4]=[v(" \u94FE\u8DEF ")])),_:1}),t(l,{to:{path:"/main/trace/dashboard"}},{default:o(()=>a[5]||(a[5]=[v(" \u8D85\u65F6\u7EDF\u8BA1 ")])),_:1})]),_:1})]),_:1}),t(z,{class:"table-card"},{default:o(()=>[t(r,{class:"cascader-div"},{default:o(()=>[t(S,{inline:!0},{default:o(()=>[t(u,{style:{width:"40%"},label:"\u8D77\u6B62\u65F6\u95F4"},{default:o(()=>[t(e,{modelValue:i.value,"onUpdate:modelValue":a[0]||(a[0]=f=>i.value=f),type:"datetimerange","range-separator":"\u5230","start-placeholder":"\u5F00\u59CB\u65F6\u95F4","end-placeholder":"\u7ED3\u675F\u65F6\u95F4"},null,8,["modelValue"])]),_:1}),t(u,{style:{width:"40%"},label:"Span\u540D\u79F0",prop:"spanName"},{default:o(()=>[t(p,{style:{width:"100%"},placeholder:"\u8BF7\u9009\u62E9\u5BF9\u5E94Span\u540D\u79F0",modelValue:d.value,"onUpdate:modelValue":a[1]||(a[1]=f=>d.value=f),clearable:"",props:h,"show-all-levels":!1},null,8,["modelValue","props"])]),_:1}),t(u,null,{default:o(()=>[t(T,{type:"primary",onClick:a[2]||(a[2]=f=>c.value.drawSpanTimoutHistogram())},{default:o(()=>a[6]||(a[6]=[v(" \u7EDF\u8BA1 ")])),_:1})]),_:1})]),_:1})]),_:1}),t(A),y("div",M,[a[7]||(a[7]=y("div",null,"\u8C03\u7528\u8D85\u65F6\u7EDF\u8BA1",-1)),t(U,{ref_key:"traceTimeoutDiagramRef",ref:c,spanNameCascade:d.value,startAndStopTime:i.value},null,8,["spanNameCascade","startAndStopTime"])])]),_:1})])}}},O=x(q,[["__scopeId","data-v-da3307d9"]]);export{O as default};
